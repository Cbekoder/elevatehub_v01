{% extends 'base.html' %}

{% block title %}{{ category.name }} - Maqsadlar{% endblock %}

{% block content %}
<style>
    body { background-color: #f8fafc; }
    .filter-link.active {
        background-color: #eef2ff; /* indigo-100 */
        color: #4338ca; /* indigo-700 */
        font-weight: 600;
    }
    .goal-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    .goal-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }
</style>

<div class="container mx-auto py-8 px-4">
    <div class="flex flex-col md:flex-row gap-8">
        <!-- Sidebar -->
        <aside class="w-full md:w-1/4 lg:w-1/5">
            <div class="bg-white p-5 rounded-2xl shadow-sm sticky top-24">
                <a href="{% url 'home' %}" class="flex items-center text-gray-600 hover:text-indigo-600 mb-6 font-medium">
                    <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    <span>{{ category.name }}</span>
                </a>
                <h3 class="font-bold text-lg mb-4 text-gray-800">Barcha vaqt uchun</h3>
                <ul class="space-y-2 text-gray-600">
                    <li><a href="{% url 'category_detail' category.slug %}?filter=all" class="filter-link flex justify-between items-center p-3 rounded-lg {% if not request.GET.filter or request.GET.filter == 'all' %}active{% else %}hover:bg-gray-100{% endif %}">
                        <span>Barchasi</span>
                        {% if not request.GET.filter or request.GET.filter == 'all' %}<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>{% endif %}
                    </a></li>
                    <li><a href="{% url 'category_detail' category.slug %}?filter=month" class="filter-link flex justify-between items-center p-3 rounded-lg {% if request.GET.filter == 'month' %}active{% else %}hover:bg-gray-100{% endif %}">
                        <span>Oy</span>
                        {% if request.GET.filter == 'month' %}<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>{% endif %}
                    </a></li>
                    <li><a href="{% url 'category_detail' category.slug %}?filter=week" class="filter-link flex justify-between items-center p-3 rounded-lg {% if request.GET.filter == 'week' %}active{% else %}hover:bg-gray-100{% endif %}">
                        <span>Hafta</span>
                        {% if request.GET.filter == 'week' %}<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>{% endif %}
                    </a></li>
                    <li><a href="{% url 'category_detail' category.slug %}?filter=day" class="filter-link flex justify-between items-center p-3 rounded-lg {% if request.GET.filter == 'day' %}active{% else %}hover:bg-gray-100{% endif %}">
                        <span>Kun</span>
                        {% if request.GET.filter == 'day' %}<svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>{% endif %}
                    </a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="w-full md:w-3/4 lg:w-4/5">
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                {% for goal in goals %}
                <div class="goal-card bg-white p-5 rounded-2xl shadow-sm flex flex-col justify-between">
                    <div>
                        <div class="flex items-center mb-3">
                            <img class="w-8 h-8 rounded-full object-cover mr-2" src="https://i.pravatar.cc/150?u={{ goal.created_by.username }}" alt="{{ goal.created_by.username }}">
                            <span class="text-sm text-gray-600 font-medium">{{ goal.created_by.first_name|default:goal.created_by.username }}</span>
                        </div>
                        <h3 class="font-bold text-gray-800 mb-4 leading-tight">{{ goal.title }}</h3>
                    </div>
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500 space-y-1">
                            <div class="flex items-center">
                                <svg class="w-4 h-4 mr-1.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18"></path></svg>
                                {{ goal.duration }} kun qoldi
                            </div>
                            <div class="flex items-center">
                                <svg class="w-4 h-4 mr-1.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962a3.75 3.75 0 100-5.925 3.75 3.75 0 000 5.925zM12 21a9.094 9.094 0 01-3.741-.479 3 3 0 01-4.682-2.72M12 3a9.094 9.094 0 013.741.479 3 3 0 014.682 2.72m-7.5 2.962a3.75 3.75 0 100-5.925 3.75 3.75 0 000 5.925z"></path></svg>
                                +{{ goal.subscribers.count }}
                            </div>
                        </div>
                        <a href="{% url 'goal_detail' goal.pk %}" class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition-transform hover:scale-110">
                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5"></path></svg>
                        </a>
                    </div>
                </div>
                {% empty %}
                <div class="col-span-full text-center py-16 bg-white rounded-2xl shadow-sm">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                      <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
                    </svg>
                    <h3 class="mt-2 text-sm font-semibold text-gray-900">Maqsadlar topilmadi</h3>
                    <p class="mt-1 text-sm text-gray-500">Ushbu filter bo'yicha hali ommaviy maqsadlar yo'q.</p>
                </div>
                {% endfor %}
            </div>
        </main>
    </div>
</div>
{% endblock %}
